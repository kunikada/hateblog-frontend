# アーカイブ（年選択）

## 画面概要
- **画面名**: アーカイブ（年選択）
- **URL**: `/archive`
- **目的**: 利用可能な年のリストを表示し、年を選択して月別アーカイブへ遷移

## レイアウト構成

### ページヘッダー
- ページタイトル: "アーカイブ"
- 説明文: "過去のエントリーを年月日で探す"

### メインコンテンツ
- 年リスト（降順）
  - 各年のカード表示
  - 年の総エントリー数表示
  - クリックで月別アーカイブへ遷移

### サイドバー（オプション、PC版のみ）
- 最近の年へのクイックリンク
- 年間ランキングへのリンク

## 年カード構成

### 表示要素
- 年（大きく表示）: 例: "2025"
- 総エントリー数: 例: "12,345 エントリー"
- 月別サマリー（折りたたみ可能）
  - 各月のエントリー数をバーグラフで表示
- 詳細を見るボタン（または年全体をクリック領域に）

### レイアウト
- PC: 2-3列グリッド
- タブレット: 2列グリッド
- SP: 1列リスト

### インタラクション
- ホバー時: 影を表示、カーソルをポインターに
- クリック: `/archive/{year}` へ遷移

## API連携

### 初期表示（年リスト取得）

実際のAPIエンドポイントには年リスト取得がないため、以下の方法を検討:

#### 方法1: フロントエンド側で年リストを生成
```javascript
// 2005年（はてなブックマーク開始年）から現在年までを生成
const currentYear = new Date().getFullYear();
const startYear = 2005;
const years = [];
for (let year = currentYear; year >= startYear; year--) {
  years.push(year);
}
```

#### 方法2: 各年の月別データを取得して年リストを構築
```
GET /api/v1/archive?year={year}
```

各年に対してAPIをリクエストし、データがある年のみ表示。
ただし、これは多数のリクエストが必要なため推奨しない。

### 年別総エントリー数取得

各年のエントリー数を取得するため、月別データを集計:
```
GET /api/v1/archive?year={year}
```

レスポンス:
```json
{
  "year": 2025,
  "month": null,
  "items": [
    { "date": "2025-01", "count": 1234 },
    { "date": "2025-02", "count": 1100 },
    // ...
    { "date": "2025-12", "count": 1456 }
  ]
}
```

総エントリー数 = items の count の合計

## インタラクション

### 年カードクリック
1. 年カードをクリック
2. `/archive/{year}` に遷移（月別アーカイブページ）

### 月別サマリー展開（オプション）
1. 展開アイコンをクリック
2. 月別エントリー数のバーグラフをアニメーション表示
3. 各月をクリックで `/archive/{year}/{month}` に遷移

## 状態管理

### ローカルステート
- 年リスト（years）
- 各年の月別データ（yearlyData）
  - `{ [year]: { total: number, months: MonthData[] } }`
- ローディング状態（isLoading）
- エラー状態（error）
- 展開中の年（expandedYear、オプション）

### グローバルステート
- なし（ページ固有のデータ）

## デザインガイドライン

### 年カード
- 背景: 白（ライト）/ ダークグレー（ダーク）
- ボーダー: 1px solid #DDD
- パディング: 24px
- ホバー時: 影を表示（0 4px 12px rgba(0,0,0,0.1)）
- 角丸: 12px

### 年表示
- フォントサイズ: 48px
- フォントウェイト: Bold
- カラー: Hatebuブルー

### 総エントリー数
- フォントサイズ: 18px
- フォントウェイト: Regular
- カラー: グレー（#666）

### 月別バーグラフ（オプション）
- バーの高さ: エントリー数に比例
- バーのカラー: Hatebuブルー（グラデーション）
- ホバー時: 月名とエントリー数をツールチップ表示

## アクセシビリティ

- 年カード: `role="link"` または `<a>` タグを使用
- 年表示: `<h2>` タグ
- 総エントリー数: `aria-label="2025年の総エントリー数: 12,345件"`
- キーボードナビゲーション対応（Enter/Spaceで遷移）

## パフォーマンス

- 初期表示: 年リストのみ表示（月別データは遅延取得）
- 月別データ: IntersectionObserverで画面に入ったら取得
- キャッシュ: 一度取得した年別データはキャッシュ

## エラーハンドリング

### APIエラー
- 特定の年のデータ取得に失敗した場合: その年のみエラー表示
- 他の年は正常に表示

### データなし
- エントリーが存在しない年: カードをグレーアウト表示
- クリック不可

## テスト観点

### 表示テスト
- [ ] ページタイトル"アーカイブ"が表示される
- [ ] 年リストが降順に表示される
- [ ] 各年カードに年と総エントリー数が表示される
- [ ] 現在年から2005年（開始年）まで表示される

### 機能テスト
- [ ] 年カードをクリックすると月別アーカイブページに遷移する
- [ ] 月別サマリーを展開できる（オプション機能の場合）
- [ ] 各月をクリックすると日別アーカイブページに遷移する（オプション機能の場合）

### レスポンシブテスト
- [ ] PC表示で2-3列グリッド
- [ ] タブレット表示で2列グリッド
- [ ] SP表示で1列リスト

### パフォーマンステスト
- [ ] 初期表示が2秒以内
- [ ] 月別データの遅延取得が機能する
- [ ] スクロールがスムーズ

## 備考
- 年リスト取得のための専用APIエンドポイントがない場合、フロントエンド側で年リストを生成する
- 月別データは遅延取得し、パフォーマンスを最適化する
- 将来的に年の範囲が広がる場合は、ページネーションやフィルタ機能を検討
