# アーカイブ

## 画面概要
- **画面名**: アーカイブ
- **URL**: `/archive`
- **URLパラメータ**: なし（クエリで `year`）
- **目的**: 全期間の日別エントリー件数を一覧し、該当日のエントリーへ遷移

### URL例
- `/archive?year=2024`（特定年で絞り込み）

## レイアウト構成

### ページヘッダー
- タイトル: "アーカイブ"
- 説明: "過去のエントリーを日付で探す"
- 総エントリー数表示

### フィルタ/ソート
- 年選択ドロップダウン（全期間/各年）
- ソート: 日付降順（初期）/ 日付昇順 / 件数降順

### メインコンテンツ
- 日別エントリー件数テーブル
  - 日付（YYYY-MM-DD）
  - 件数
  - 件数バー（相対長さ）
  - 行クリックで該当日エントリー一覧へ
- 仮想スクロール or ページネーション（100件単位）

## テーブル行構成

### 表示要素
- 日付 + 曜日
- エントリー件数（例: "1,234 件"）
- 件数バー（最大値100%基準、Hatebuブルー）

### レイアウト
- PC: テーブル3列
- タブレット: 2列（バー省略可）
- SP: 縦並びリスト

### インタラクション
- 行ホバーでハイライト
- 行クリックで `/entries/{YYYYMMDD}/hot` に遷移

## API連携

### 初期データ取得
```
GET /api/v1/archive
```

#### クエリパラメータ（任意）
- `year`: 特定年のみ取得（省略時は全期間）
- `limit`: 取得件数（デフォルト: 100）
- `offset`: オフセット

#### レスポンス
- `openapi.yaml` を参照

### パフォーマンス最適化
- 直近100件を先に取得し、スクロールで追加ロード
- 年フィルタでデータ量を抑制

## インタラクション

### 年フィルタ
1. ドロップダウンで年を選択
2. `?year={year}` を付与して再取得

### ソート切替
1. ソートボタンを選択
2. テーブルを再ソート（降順/昇順/件数）

### 行クリック
1. 日付行をクリック
2. `/entries/{YYYYMMDD}/hot` へ遷移
3. 必要に応じて閲覧履歴を保存

## 状態管理

### ローカルステート
- `selectedYear`: 年フィルタ
- `sortOrder`: `date_desc` | `date_asc` | `count_desc`
- `archiveData`: `{ date, count, day_of_week }[]`
- `total`: 総件数
- `maxCount`: 件数バーの基準値
- `isLoading`, `error`

### グローバルステート
- なし

## デザインガイドライン
- テーブル背景: 白 / ダークグレー、ボーダー1px #DDD、パディング16px
- 日付: Medium、曜日はグレー(#666)
- 件数: 18px Bold、Hatebuブルー
- バー: 高さ8px、角丸4px、初期表示で左→右のアニメーション

## アクセシビリティ
- `<table>` を使用し、行は `role="link"` または `<a>` で包む
- 日付は `<time>`、件数は `aria-label="{date}のエントリー件数: {count}件"`
- ソートボタンに `aria-label` を付与

## パフォーマンス
- 初期表示2秒以内
- 仮想スクロールで大量データ対応
- 年フィルタ + キャッシュでリクエスト削減

## エラーハンドリング
- API 500: "サーバーエラーが発生しました"
- ネットワーク断: "ネットワークに接続できません"（再試行ボタン）
- データなし: "該当期間のアーカイブデータがありません"

## テスト観点

### 表示
- [ ] タイトルと総件数が表示される
- [ ] テーブルに日付/件数/バーが表示される
- [ ] 年フィルタとソートUIが表示される

### 機能
- [ ] 年フィルタ変更でデータが絞り込まれる
- [ ] ソート切替で並び順が変わる
- [ ] 行クリックで該当日の一覧に遷移する
- [ ] 無限スクロールで追加読み込みされる

### レスポンシブ
- [ ] PCで3列、タブレットで2列、SPで縦並びになる

### パフォーマンス
- [ ] 初期表示が2秒以内
- [ ] 大量データでもスクロールがスムーズ

## 備考
- 大量データ前提のため仮想スクロールと年フィルタを重視
