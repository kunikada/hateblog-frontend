# タグ別エントリー一覧

## 画面概要
- **画面名**: タグ別エントリー一覧
- **URL**: `/tags/:tag`
- **URLパラメータ**:
  - `tag`: タグ名（URLエンコード）
  - `min_users`: 最低ブックマーク件数フィルタ（オプション、デフォルト: 5）
  - `page`: ページ番号（デフォルト: 1）
- **目的**: 指定タグに紐づくエントリーを新着順で表示

## レイアウト構成

### パンくずリスト
- タグ > {tag_name}

### ページヘッダー
- タグ名表示（大きく、アイコン付き）
  - 例: "タグ: Go"
- タグ説明文（オプション）
  - タグの簡単な説明（将来的な拡張）
- エントリー数表示
  - 例: "1,234 エントリー"

### 関連タグセクション（オプション）
- 関連タグバッジ（横並び）
  - クリックで該当タグのエントリー一覧へ遷移
  - 例: 関連タグ: "プログラミング", "Web", "開発"

### フィルタバー
- はてなブックマーク件数閾値チップ
  - 5 users / 10 users / 50 users / 100 users / 500 users / 1000 users
  - 複数選択可能（OR条件）
  - クリアボタン
- PC: 水平配置
- SP: 横スクロールチップ

### メインコンテンツ
- エントリーカードリスト
  - PC: 2列グリッド
  - SP: 1列リスト
- 読み込み中: スケルトンスクリーン表示

### ページネーション
- 前のページ / 次のページボタン
- ページ番号表示（現在ページ / 総ページ数）

## エントリーカード構成

新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## API連携

### 初期表示（タグ別エントリー取得）
```
GET /api/v1/tags/{tag}/entries?min_users={number}&limit=25&offset=0
```

#### リクエストパラメータ
- `tag`: タグ名（パスパラメータ、URLエンコード）
- `min_users`: 最低ブックマーク件数（5/10/50/100/500/1000）
- `limit`: 取得件数（デフォルト: 25）
- `offset`: オフセット（ページネーション用）

#### レスポンス
```json
{
  "entries": [
    {
      "id": "uuid",
      "title": "記事タイトル",
      "url": "https://example.com/article",
      "posted_at": "2025-01-05T10:30:00Z",
      "bookmark_count": 150,
      "excerpt": "記事の抜粋...",
      "tags": [
        {
          "tag_id": "uuid",
          "tag_name": "Go",
          "score": 0.95
        }
      ],
      "favicon_url": "https://www.google.com/s2/favicons?domain=example.com"
    }
  ],
  "total": 1234,
  "limit": 25,
  "offset": 0
}
```

### タグ情報取得（オプション）
関連タグやタグ説明を取得する場合:
```
GET /api/v1/tags
```

全タグリストから該当タグを検索。

### クリック計測
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## インタラクション

### 閾値フィルタ選択
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

### エントリーカードクリック
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

### タグクリック（関連タグ）
- `/tags/{tag_name}` に遷移

### ページネーション
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## 状態管理

### ローカルステート
- タグ名（tagName）
- 選択閾値フィルタ（minUsers）
- 現在ページ（page）
- エントリーリスト（entries）
- 総件数（total）
- ローディング状態（isLoading）
- エラー状態（error）

### localStorage
- `viewHistory`: 閲覧履歴配列

## デザインガイドライン

### タグ名表示
- フォントサイズ: 32px
- フォントウェイト: Bold
- アイコン: タグアイコン（#アイコン）
- カラー: Hatebuブルー

### エントリー数表示
- フォントサイズ: 18px
- カラー: グレー（#666）

### 関連タグバッジ
- 背景: 薄いグレー（#F5F5F5）
- ボーダー: 1px solid #DDD
- パディング: 6px 12px
- 角丸: 16px（pill型）
- ホバー時: 背景色をHatebuブルー、テキスト色を白

### エントリーカード
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## アクセシビリティ

- パンくずリスト: `<nav aria-label="Breadcrumb">`
- タグ名: `<h1>`
- 関連タグ: `aria-label="関連タグ"`
- エントリーカード: `role="article"`
- キーボードナビゲーション対応

## パフォーマンス

- 初期表示: 2秒以内
- Faviconの遅延読み込み
- APIレスポンスキャッシュ（同一タグ・閾値の場合）

## エラーハンドリング

### APIエラー
- 400 Bad Request: "タグ名が正しくありません"
- 404 Not Found: "タグが見つかりません"
- 500 Server Error: "サーバーエラーが発生しました"
- エラーメッセージをトースト表示
- 再試行ボタン表示

### データなし
- "該当するエントリーがありません"
- タグ一覧へ戻るリンク表示

## テスト観点

### 表示テスト
- [ ] パンくずリストが表示される
- [ ] タグ名が表示される
- [ ] エントリー数が表示される
- [ ] 関連タグバッジが表示される（オプション）
- [ ] 閾値フィルタチップが表示される
- [ ] エントリーカードが表示される（25件）
- [ ] ページネーションが表示される

### 機能テスト
- [ ] 閾値フィルタを変更するとエントリーがフィルタされる
- [ ] エントリーカードクリックで元記事が新規タブで開く
- [ ] タグクリック（関連タグ）でタグ別一覧ページに遷移する
- [ ] ページネーションが動作する

### レスポンシブテスト
- [ ] PC表示で2列グリッド
- [ ] SP表示で1列リスト
- [ ] 閾値フィルタが横スクロール可能（SP）

### パフォーマンステスト
- [ ] 初期表示が2秒以内
- [ ] スクロールがスムーズ

## 備考
- タグ別エントリー一覧は新着順エントリー一覧と多くの実装を共通化できる
- 関連タグ機能は将来的な拡張として検討
- タグ説明文は将来的にCMSなどで管理することを検討
