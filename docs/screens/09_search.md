# 検索結果

## 画面概要
- **画面名**: 検索結果
- **URL**: `/search/:search`
- **URLパラメータ**:
  - `search`: 検索キーワード
  - `min_users`: 最低ブックマーク件数（任意、デフォルト: 5）
  - `page`: ページ番号（デフォルト: 1）
- **目的**: キーワード全文検索の結果を一覧表示

### URL例
- `/search/Go言語`
- `/search/React`

## レイアウト構成

### ページヘッダー
- タイトル: "検索結果"
- キーワード表示（例: "「Go言語」の検索結果"）
- 件数表示（例: "123 件見つかりました"）

### 検索フォーム（再検索）
- テキスト入力（初期値: 現在のキーワード）
- 検索ボタン
- 検索種別セレクタ（拡張枠: 全文/タイトル/タグ）

### フィルタバー
- はてブ件数閾値チップ 5/10/50/100/500/1000（複数選択可）
- PC: 水平配置、SP: 横スクロールチップ

### メインコンテンツ
- 検索結果エントリーカード（PC: 2列、SP: 1列）
- キーワードハイライトをタイトル/抜粋に適用
- スケルトンをローディング時に表示

### ページネーション
- 前/次ボタン + ページ番号

## エントリーカード構成
- 基本は [docs/screens/03_entries_new.md](docs/screens/03_entries_new.md) と同一
- 追加: タイトル/抜粋のキーワードハイライト、関連度スコア（任意）

## API連携

### 初期データ取得
```
GET /api/v1/search?q={keyword}&min_users={number}&limit=25&offset=0
```

#### リクエストパラメータ
- `q`: キーワード（1-500文字、必須）
- `min_users`: 5/10/50/100/500/1000
- `limit`: 25（デフォルト）
- `offset`: ページング用

#### レスポンス
- `openapi.yaml` を参照

### クリック計測
- カードクリックは [docs/screens/03_entries_new.md](docs/screens/03_entries_new.md) と同一処理

## インタラクション

### 再検索
1. 入力/検索ボタンで `/search/{keyword}` に遷移
2. APIを再リクエスト

### 閾値フィルタ
- チップ選択/解除で再取得し、件数を更新

### エントリーカード
- クリック計測後に新規タブで元記事を開く

### ページネーション
- `page` を変更して再取得（offset計算）

## 状態管理

### ローカルステート
- `query`, `minUsers[]`, `page`
- `entries`, `total`
- `isLoading`, `error`

### localStorage
- `searchHistory`（任意、`{ keyword, searched_at }[]`）

## デザインガイドライン
- キーワード表示: 24px Bold、#333
- 件数表示: 16px、グレー(#666)
- ハイライト: `<mark>` or `<strong>`、背景#FFFF00半透明、文字色#333
- カードは [docs/screens/03_entries_new.md](docs/screens/03_entries_new.md) と同一スタイル

## アクセシビリティ
- 検索フォーム: `<form role="search">`
- 件数表示: `aria-live="polite"`
- ハイライトは `<mark>` 推奨
- キーボードナビゲーション対応

## パフォーマンス
- 初期表示2秒以内
- 入力デバウンス ~300ms（再検索時）
- 同一キーワード/閾値のキャッシュ再利用
- Favicon遅延読み込み

## エラーハンドリング
- 400: "検索キーワードが正しくありません"
- 500: "サーバーエラーが発生しました"
- データなし: "「{keyword}」に該当するエントリーがありませんでした"
- キーワード未入力: "検索キーワードを入力してください"
- いずれもトースト表示 + 再試行/トップへの導線

## テスト観点

### 表示
- [ ] キーワードと件数が表示される
- [ ] 検索フォームが初期値入りで表示される
- [ ] 閾値チップが表示される
- [ ] カードとハイライト、ページネーションが表示される

### 機能
- [ ] 再検索でキーワードが更新され結果が変わる
- [ ] 閾値変更で結果がフィルタされる
- [ ] カードクリックで元記事が新規タブで開く
- [ ] ページネーションが動作する
- [ ] 未入力時にバリデーションエラーが出る

### レスポンシブ
- [ ] PCで2列、SPで1列
- [ ] フィルタバーが横スクロール可能（SP）

### パフォーマンス
- [ ] 初期表示が2秒以内
- [ ] デバウンスが有効に働く
