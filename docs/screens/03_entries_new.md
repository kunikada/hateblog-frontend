# 新着順エントリー一覧

## 画面概要
- **画面名**: 新着順エントリー一覧
- **URL**: `/entries/:date/new`
- **URLパラメータ**:
  - `date`: 対象日付（YYYYMMDD形式）
- **目的**: 指定日付のエントリーを新着順（posted_at DESC）で表示

### URL例
- `/entries/20241215/new` - 2024年12月15日の新着エントリー

## レイアウト構成

### ページヘッダー
- ページタイトル: "2024年12月15日の新着エントリー"
- 前日/翌日ナビゲーションボタン

### フィルタバー
- はてなブックマーク件数閾値チップ
  - 5 users（デフォルト） / 10 users / 50 users / 100 users / 500 users / 1000 users

### メインコンテンツ
- エントリー件数
- エントリーカードリスト
- 読み込み中: スケルトンスクリーン表示

## エントリーカード構成

### 上部
- Favicon（左）+ タイトル

### 中央
- 記事抜粋（100-200文字）
- タグ一覧
  - クリックでタグ別一覧ページへ遷移

### 下部
- はてなブックマーク件数バッジ
  - クリックではてなブックマーク詳細ページへ遷移
- ドメイン
  - クリックで同じドメインの一覧ページを表示
- 投稿日
- 共有アイコンバー（hover/tapで展開）
  - Twitter
  - Facebook
  - Instagram
  - リンクをコピー
  - スマホの場合は単純な共有ボタン

## API連携

### 初期データ
```
GET /api/v1/entries/new?date={YYYYMMDD}
```

#### リクエストパラメータ
- `date`: 対象日付（YYYYMMDD形式）

#### レスポンス
openapi.yamlを参照

### クリック計測
エントリーカードクリック時:
```
POST /api/v1/metrics/clicks
Content-Type: application/json

{
  "entry_id": "uuid",
  "referrer": "https://hateblog.jp/entries/new",
  "user_agent": "Mozilla/5.0..."
}
```

### Favicon取得
```
GET /api/v1/favicons?domain=example.com
```

#### リクエストパラメータ
- `domain`: Faviconを取得するドメイン名 

#### レスポンス
openapi.yamlを参照

## インタラクション

### 初期表示
1. 初期データをリクエスト
2. localStorageの閾値でフィルタリング

### 前日/翌日ナビゲーション
- 前日ボタン: 1日前の日付のページに遷移
- 翌日ボタン: 1日後の日付のページに遷移
- 未来日付の場合は翌日ボタンを無効化

### 閾値フィルタ選択
1. チップをクリック
2. 選択状態をトグル（ON/OFF）
3. エントリーリストをフィルタリング
4. エントリー件数を更新

### エントリーカードクリック
1. タイトルがクリック領域
2. クリック計測APIを呼び出し（非同期）
3. 元記事URLを新規タブで開く
4. 閲覧履歴をlocalStorageに保存

### タグクリック
- `/tags/{tag_name}` に遷移

### ブックマーク件数クリック
- `https://b.hatena.ne.jp/entry/s/{raw_url}`

### ドメインをクリック
- ドメインをキーワードにして検索ページに遷移

### 共有アイコンクリック
- PCの場合はホバーとする
  - Twitter
  - Facebook
  - Instagram
  - リンクをコピー
- スマホの場合は単純な共有機能とする

### 無限スクロール
- 初期表示: 25件
- スクロールでロードトリガーに到達すると25件追加読み込み
- 読み込み中はスピナー表示
- 全件表示完了時は何もなし
- 実際のデータは初回で全件取得済み（疑似的な無限スクロール）

## 状態管理

### ローカルステート
- エントリーリスト（entries）
- 総件数（total）
- ローディング状態（isLoading）
- エラー状態（error）

### localStorage
- `minUsers`: 選択閾値フィルタ
- `viewHistory`: 閲覧履歴配列

## デザインガイドライン

### エントリーカード
- 背景: 白（ライト）/ ダークグレー（ダーク）
- ボーダー: 1px solid #DDD
- パディング: 16px
- ホバー時: 影を表示、カーソルをポインターに
- 角丸: 8px

### 閾値チップ
- 未選択: グレー背景、グレーテキスト
- 選択中: Hatebuブルー背景、白テキスト
- パディング: 8px 16px
- 角丸: 20px（pill型）

### ブックマーク件数バッジ
- アイコン: はてなブックマークアイコン
- テキスト: 件数表示
- カラー: Hatebuブルー

## アクセシビリティ

- エントリーカード: `role="article"`
- タグリンク: `aria-label="タグ: {tag_name}"`
- ページネーション: `aria-label="ページネーション"`
- 閾値チップ: `aria-pressed="true/false"`
- ローディング時: `aria-busy="true"`

## パフォーマンス

- 初期表示: 2秒以内
- Faviconの遅延読み込み

## エラーハンドリング

### APIエラー
- 200以外はエラー状態とする

### ネットワークエラー
- エラー状態とする

### データなし
- "該当するエントリーがありません"
- APIのデータがない場合
- フィルタによるデータがない場合

## テスト観点

### 表示テスト
- [ ] ページタイトルと日付が表示される
- [ ] 日付選択カレンダーが表示される
- [ ] 前日/翌日ボタンが表示される
- [ ] 閾値フィルタチップが表示される
- [ ] エントリーカードが表示される（25件）
- [ ] ページネーションが表示される

### 機能テスト
- [ ] 日付を変更するとエントリーが更新される
- [ ] 前日ボタンで前日のエントリーが表示される
- [ ] 翌日ボタンで翌日のエントリーが表示される
- [ ] 閾値フィルタを変更するとエントリーがフィルタされる
- [ ] エントリーカードクリックで元記事が新規タブで開く
- [ ] タグクリックでタグ別一覧ページに遷移する
- [ ] 共有アイコンクリックで共有URLが開く
- [ ] ページネーションが動作する

### レスポンシブテスト
- [ ] PC表示で2列グリッド
- [ ] SP表示で1列リスト
- [ ] 閾値フィルタが横スクロール可能（SP）

### パフォーマンステスト
- [ ] 初期表示が2秒以内
- [ ] スクロールがスムーズ
- [ ] ローディング中はスケルトンスクリーン表示
