# アーカイブ（月選択）

## 画面概要
- **画面名**: アーカイブ（月選択）
- **URL**: `/archive/:year`
- **URLパラメータ**:
  - `year`: 対象年（YYYY形式）
  - `min_users`: 最低ブックマーク件数フィルタ（オプション、デフォルト: 5）
- **目的**: 指定年の月別エントリー数を表示し、月を選択して日別アーカイブへ遷移

## レイアウト構成

### パンくずリスト
- アーカイブ > 2025年

### ページヘッダー
- ページタイトル: "2025年のアーカイブ"
- 年選択ナビゲーション
  - 前年ボタン（存在する場合）
  - 年表示（ドロップダウンまたはテキスト）
  - 翌年ボタン（存在する場合）

### フィルタバー（オプション）
- はてなブックマーク件数閾値チップ
  - 5 users / 10 users / 50 users / 100 users / 500 users / 1000 users

### メインコンテンツ
- 月別カレンダービュー または 月別リストビュー
- 各月のエントリー数を表示
- クリックで日別アーカイブへ遷移

### 月別ビジュアライゼーション（オプション）
- 月別エントリー数のバーグラフ
- 月別エントリー数のヒートマップ

## 月カード構成

### 表示要素
- 月名: 例: "1月"
- エントリー数: 例: "1,234 エントリー"
- 新着/人気リンク
  - 新着順で見る
  - 人気順で見る
- 詳細を見るボタン（日別アーカイブへ）

### レイアウト
- PC: 3-4列グリッド（12ヶ月を表示）
- タブレット: 2-3列グリッド
- SP: 2列グリッドまたは1列リスト

### インタラクション
- ホバー時: 影を表示、カーソルをポインターに
- クリック: `/archive/{year}/{month}` へ遷移

## API連携

### 初期表示（月別データ取得）
```
GET /api/v1/archive?year={year}&min_users={number}
```

#### リクエストパラメータ
- `year`: 対象年（YYYY形式、必須）
- `min_users`: 最低ブックマーク件数フィルタ（オプション、デフォルト: 5）

#### レスポンス
```json
{
  "year": 2025,
  "month": null,
  "items": [
    { "date": "2025-01", "count": 1234 },
    { "date": "2025-02", "count": 1100 },
    { "date": "2025-03", "count": 1050 },
    // ...
    { "date": "2025-12", "count": 1456 }
  ]
}
```

## インタラクション

### 月カードクリック
1. 月カードをクリック
2. `/archive/{year}/{month}` に遷移（日別アーカイブページ）

### 新着/人気リンククリック
- 新着順で見る: `/entries/new?date={year}{month}01` に遷移
- 人気順で見る: `/entries/hot?date={year}{month}01` に遷移

### 前年/翌年ナビゲーション
- 前年ボタン: `year - 1` でページ再読み込み
- 翌年ボタン: `year + 1` でページ再読み込み
- 未来年（現在年より後）の場合は翌年ボタンを無効化

### 閾値フィルタ変更
1. チップをクリック
2. URLパラメータ更新: `?min_users={number}`
3. API再リクエスト

## 状態管理

### ローカルステート
- 対象年（year）
- 月別データ（monthlyData）
  - `{ date: string, count: number }[]`
- 選択閾値フィルタ（minUsers）
- ローディング状態（isLoading）
- エラー状態（error）

### グローバルステート
- なし（ページ固有のデータ）

## デザインガイドライン

### 月カード
- 背景: 白（ライト）/ ダークグレー（ダーク）
- ボーダー: 1px solid #DDD
- パディング: 20px
- ホバー時: 影を表示（0 4px 12px rgba(0,0,0,0.1)）
- 角丸: 8px

### 月名表示
- フォントサイズ: 24px
- フォントウェイト: Bold
- カラー: #333（ライト）/ #EEE（ダーク）

### エントリー数
- フォントサイズ: 18px
- フォントウェイト: Regular
- カラー: Hatebuブルー

### バーグラフ（オプション）
- バーの高さ: エントリー数に比例
- バーのカラー: Hatebuブルー（グラデーション）
- X軸: 月（1-12）
- Y軸: エントリー数

## アクセシビリティ

- パンくずリスト: `<nav aria-label="Breadcrumb">`
- 月カード: `role="link"` または `<a>` タグを使用
- 月名: `<h3>` タグ
- エントリー数: `aria-label="1月のエントリー数: 1,234件"`
- キーボードナビゲーション対応

## パフォーマンス

- 初期表示: 2秒以内
- 月別データ一括取得（12ヶ月分）
- データキャッシュ（同一年・閾値の場合は再利用）

## エラーハンドリング

### APIエラー
- 400 Bad Request: "年の形式が正しくありません"
- 500 Server Error: "サーバーエラーが発生しました"
- エラーメッセージをトースト表示
- 再試行ボタン表示

### データなし
- "該当する月別データがありません"
- 年選択へ戻るリンク表示

## テスト観点

### 表示テスト
- [ ] パンくずリストが表示される
- [ ] ページタイトルに年が表示される
- [ ] 前年/翌年ボタンが表示される
- [ ] 月別カード（12ヶ月分）が表示される
- [ ] 各月のエントリー数が表示される

### 機能テスト
- [ ] 月カードをクリックすると日別アーカイブページに遷移する
- [ ] 新着順リンクをクリックすると新着順エントリー一覧に遷移する
- [ ] 人気順リンクをクリックすると人気順エントリー一覧に遷移する
- [ ] 前年ボタンで前年の月別アーカイブが表示される
- [ ] 翌年ボタンで翌年の月別アーカイブが表示される
- [ ] 閾値フィルタを変更するとエントリー数が更新される

### レスポンシブテスト
- [ ] PC表示で3-4列グリッド
- [ ] タブレット表示で2-3列グリッド
- [ ] SP表示で2列グリッドまたは1列リスト

### パフォーマンステスト
- [ ] 初期表示が2秒以内
- [ ] 年切り替えがスムーズ

## 備考
- 月別データは一括取得し、フロントエンド側で集計・表示
- ビジュアライゼーション（バーグラフ、ヒートマップ）は将来的な拡張として検討
