# 年次ランキング

## 画面概要
- **画面名**: 年次ランキング（はてブ・オブ・ザ・イヤー）
- **URL**: `/rankings/:year`
- **URLパラメータ**:
  - `year`: 対象年（YYYY形式）
  - `limit`: 取得件数（オプション、デフォルト: 100）
- **目的**: 指定年のブックマーク件数上位エントリーを表示（年間ベストエントリー）

## レイアウト構成

### ページヘッダー
- ページタイトル: "はてブ・オブ・ザ・イヤー 2024"
- 年選択ナビゲーション
  - 前年ボタン
  - 年表示（ドロップダウン）
  - 翌年ボタン
- サブタイトル/説明文: "2024年に最もブックマークされたエントリーTOP 100"

### ヒーローセクション（オプション）
- 年間トップ3のエントリーを大きく表示
  - 1位: ゴールドバッジ + 大きなカード
  - 2位: シルバーバッジ + 中サイズカード
  - 3位: ブロンズバッジ + 中サイズカード

### 月次ランキングリンク
- 各月へのクイックリンク
  - "1月のランキング" 〜 "12月のランキング"
  - PC: 水平スクロール
  - SP: 横スクロールチップ

### メインコンテンツ
- ランキングエントリーリスト（4位〜100位）
  - 順位バッジ
  - エントリーカード
  - ブックマーク件数を強調表示

### ページネーション（オプション）
- 100件を一度に表示 or ページネーション（25件ずつ）

## ランキングエントリーカード構成

### 表示要素
- 順位バッジ（左端）
  - 1-3位: 大きなメダルバッジ（ゴールド/シルバー/ブロンズ）
  - 4-10位: 大きな数字バッジ（Hatebuブルー）
  - 11位以降: 通常サイズ数字バッジ
- Favicon + ドメイン名
- タイトル（太字、リンク）
- 投稿日時
- はてなブックマーク件数（大きく強調表示）
- タグ一覧
- 記事抜粋
- 共有アクション

### レイアウト
- PC: 1列リスト（フル幅）
- SP: 1列リスト

## API連携

### 初期表示（年次ランキング取得）
```
GET /api/v1/rankings/yearly?year={year}&limit={number}
```

#### リクエストパラメータ
- `year`: 対象年（YYYY形式、必須）
- `limit`: 取得件数（オプション、デフォルト: 100、最大: 1000）

#### レスポンス
```json
{
  "period_type": "yearly",
  "year": 2024,
  "month": null,
  "week": null,
  "entries": [
    {
      "rank": 1,
      "entry": {
        "id": "uuid",
        "title": "記事タイトル",
        "url": "https://example.com/article",
        "posted_at": "2024-03-15T10:30:00Z",
        "bookmark_count": 5432,
        "excerpt": "記事の抜粋...",
        "tags": [...],
        "favicon_url": "..."
      }
    },
    // ...
  ],
  "total": 10000
}
```

### クリック計測
エントリーカードクリック時は新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## インタラクション

### 年選択
- 前年ボタン: `year - 1` でページ再読み込み
- 翌年ボタン: `year + 1` でページ再読み込み
- 年ドロップダウン: 年を選択してページ再読み込み

### 月次ランキングリンククリック
- `/rankings/{year}/{month}` に遷移

### エントリーカードクリック
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

### 共有アクション
新着順エントリー一覧と同じ。詳細は [02_entries_new.md](./02_entries_new.md) を参照。

## 状態管理

### ローカルステート
- 対象年（year）
- ランキングデータ（rankings）
  - `{ rank: number, entry: Entry }[]`
- 総エントリー数（total）
- ローディング状態（isLoading）
- エラー状態（error）

### グローバルステート
- なし（ページ固有のデータ）

## デザインガイドライン

### ヒーローセクション（TOP3）
- 1位カード:
  - サイズ: 大（幅100%、高さ200px以上）
  - バッジ: ゴールドメダル（#FFD700）
  - ブックマーク件数: 32px、ゴールドカラー
- 2位/3位カード:
  - サイズ: 中（幅48%、高さ150px）
  - バッジ: シルバー（#C0C0C0）/ ブロンズ（#CD7F32）

### 順位バッジ
- 1-3位: メダル型アイコン（48px）
- 4-10位: 円形バッジ（36px、Hatebuブルー背景、白テキスト）
- 11位以降: 円形バッジ（24px、グレー背景）

### ランキングエントリーカード
- パディング: 20px
- ボーダー: 1px solid #DDD
- マージン: 12px
- ホバー時: 影を表示

### ブックマーク件数表示
- フォントサイズ: 24px（1-10位）/ 18px（11位以降）
- カラー: Hatebuブルー
- アイコン: はてなブックマークアイコン

## アクセシビリティ

- ページタイトル: `<h1>`
- ランキングリスト: `<ol>` タグ
- エントリーカード: `<li>` タグ
- 順位: `aria-label="第1位"`
- キーボードナビゲーション対応

## パフォーマンス

- 初期表示: 3秒以内
- TOP3は優先的に表示（Above the fold）
- 残りのエントリーは遅延レンダリング検討
- データキャッシュ（同一年の場合は再利用）

## エラーハンドリング

### APIエラー
- 400 Bad Request: "年の形式が正しくありません"
- 404 Not Found: "該当年のランキングデータが見つかりません"
- 500 Server Error: "サーバーエラーが発生しました"
- エラーメッセージをトースト表示
- 再試行ボタン表示

### データなし
- "該当年のランキングデータがありません"
- 年選択へ戻るリンク表示

## テスト観点

### 表示テスト
- [ ] ページタイトルに年が表示される
- [ ] TOP3が目立つ表示になっている
- [ ] 1位がゴールドバッジで表示される
- [ ] 2位がシルバーバッジで表示される
- [ ] 3位がブロンズバッジで表示される
- [ ] 4位以降が順位バッジと共に表示される
- [ ] 月次ランキングリンクが表示される

### 機能テスト
- [ ] 前年ボタンで前年のランキングが表示される
- [ ] 翌年ボタンで翌年のランキングが表示される
- [ ] 年ドロップダウンで年を選択できる
- [ ] 月次ランキングリンクをクリックすると月次ランキングページに遷移する
- [ ] エントリーカードをクリックすると元記事が新規タブで開く
- [ ] ランキングが順位順に表示される（1位〜100位）

### レスポンシブテスト
- [ ] PC表示でTOP3が適切に配置される
- [ ] SP表示でTOP3が縦並びになる
- [ ] ランキングリストがスクロール可能

### パフォーマンステスト
- [ ] 初期表示が3秒以内
- [ ] TOP3の表示が優先される

## 備考
- 年次ランキングは年間を通じて最も注目されたエントリーを紹介する重要なページ
- TOP3のビジュアル表現を工夫し、ユーザーの興味を引く
- 月次ランキングや週次ランキングへの導線を明確にする
